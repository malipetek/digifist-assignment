{% liquid
  if section.settings.collection != blank
    assign slider_products = section.settings.collection.products | limit: 8
  elsif section.settings.products.size > 0
    assign slider_products = section.settings.products
  else
    assign slider_products = collection.products | limit: 8
  endif
%}
<div class="image-container">
  {%- capture sizes -%}
      (min-width: {{ settings.page_width }}px) calc(({{ settings.page_width }}px - 100px) * 1 / 3 - {{ grid_space_desktop }}),
      (min-width: 750px) calc((100vw - 100px) * 1 / 3 - {{ grid_space_desktop }}),
      {% if section.settings.mobile_layout == 'collage' %}calc((100vw - 30px) / 2 - {{ grid_space_mobile }}){% else %}calc(100vw - 30px){% endif %}
  {%- endcapture -%}
  {%- if section.settings.image != blank -%}
    {{
      section.settings.image
      | image_url: width: 3200
      | image_tag:
        class: 'banner-image',
        loading: 'eager',
        sizes: sizes,
        widths: '300, 400, 500, 750, 1000, 1250, 1500, 1750, 2000, 2250, 2500, 2750, 3000, 3200'
    }}
  {%- else -%}
    {{ 'lifestyle-2' | placeholder_svg_tag: 'placeholder-svg' }}
  {%- endif -%}
</div>
<div class="content-container">
  {% comment %}
    <slideshow-component
      class="slider-mobile-gutter{% if section.settings.layout == 'grid' %} page-width{% endif %}{% if section.settings.show_text_below %} mobile-text-below{% endif %}"
      role="region"
      aria-roledescription="{{ 'sections.slideshow.carousel' | t }}"
      aria-label="{{ section.settings.accessibility_info | escape }}"
    >
  {% endcomment %}
  <div class="text-content">
    <h1>collection title</h1>
    <p>collection description</p>
    <a href="collection url"> view collection </a>
  </div>
  <slider-component class="slider-mobile-gutter slider-component-full-width slider-component-desktop{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}">
    <ul
      id="Slider-{{ section.id }}"
      class="grid product-grid contains-card contains-card--product grid--2-col-desktop grid--2-col-tablet-down slider slider--desktop slider--tablet grid--peek"
      role="list"
      aria-label="{{ 'general.slider.name' | t }}"
    >
      {%- for product in slider_products -%}
        <li
          id="Slide-{{ section.id }}-{{ forloop.index }}"
          class="grid__item slider__slide scroll-trigger animate--slide-in"
          data-cascade
        >
          {% render 'card-product',
            card_product: product,
            media_aspect_ratio: 1,
            show_secondary_image: false,
            show_vendor: false,
            show_rating: false,
            show_quick_add: false,
            section_id: section.id
          %}
        </li>
      {% endfor %}
    </ul>
    <div class="slider-buttons">
      <button
        type="button"
        class="slider-button slider-button--prev"
        name="previous"
        aria-label="{{ 'general.slider.previous_slide' | t }}"
        aria-controls="Slider-{{ section.id }}"
        style="transform: rotate(180deg);"
      >
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M16.6464 13.6464C16.8417 13.4512 17.1583 13.4512 17.3536 13.6464L23.3536 19.6464C23.5488 19.8417 23.5488 20.1583 23.3536 20.3536L17.3536 26.3536C17.1583 26.5488 16.8417 26.5488 16.6464 26.3536C16.4512 26.1583 16.4512 25.8417 16.6464 25.6464L22.2929 20L16.6464 14.3536C16.4512 14.1583 16.4512 13.8417 16.6464 13.6464Z" fill="black"/>
          <rect x="0.5" y="0.5" width="39" height="39" stroke="black" stroke-opacity="0.1"/>
        </svg>
      </button>

      <button
        type="button"
        class="slider-button slider-button--next"
        name="next"
        aria-label="{{ 'general.slider.next_slide' | t }}"
        aria-controls="Slider-{{ section.id }}"
      >
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M16.6464 13.6464C16.8417 13.4512 17.1583 13.4512 17.3536 13.6464L23.3536 19.6464C23.5488 19.8417 23.5488 20.1583 23.3536 20.3536L17.3536 26.3536C17.1583 26.5488 16.8417 26.5488 16.6464 26.3536C16.4512 26.1583 16.4512 25.8417 16.6464 25.6464L22.2929 20L16.6464 14.3536C16.4512 14.1583 16.4512 13.8417 16.6464 13.6464Z" fill="black"/>
          <rect x="0.5" y="0.5" width="39" height="39" stroke="black" stroke-opacity="0.1"/>
        </svg>
      </button>
    </div>
  </slider-component>
</div>

{% liquid
  assign banner_image_object_position = 'center'
  if section.settings.image != blank
    assign banner_image_object_position = section.settings.image.presentation.focal_point.x | append: '% ' | append: section.settings.image.presentation.focal_point.y | append: '%'
  endif
%}
{% stylesheet %}
  .digifist-section-main {
    width: 100%;
    height: calc(100vh - 100px);
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 100% 100%;
  }

  .image-container {
    width: 100%;
    height: 100%;
  }
  .image-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: {{ banner_image_object_position }};

  }

  @media (max-width: 750px) {
    .digifist-section-main {
      grid-template-columns: 1fr;
      grid-template-rows: auto 45vh;
    }
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Full Page 2 Columns",
  "tag": "section",
  "class": "digifist-section-main",
  "settings": [
    {
      "type": "header",
      "content": "Banner Image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image",
      "info": "Select an image to show in the banner"
    },
    {
      "type": "header",
      "content": "Select Products for Carousel"
    },
    {
      "type": "paragraph",
      "content": "If you omit selecting products or the collection, carousel will use default collection if available."
    },
    {
      "type": "product_list",
      "id": "products",
      "label": "Products",
      "limit": 10,
      "info": "Select products to show in the carousel"
    },
    {
      "id": "collection",
      "type": "collection",
      "label": "Collection",
      "info": "Select a collection to show in the carousel"
    }
  ]
}
{% endschema %}
